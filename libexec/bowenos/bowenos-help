#!/usr/bin/env bash
set -euo pipefail

cat <<'USAGE'
Usage: bowenos <command>

Commands:
  create-iso   Build BowenOS Installer and Recovery ISO
  setup        Create /tmp/bowenos inventory
  partition    Apply target disk layout with Disko (destructive)
  install      Install NixOS for selected inventory host
  update       Switch system for current host
  hardware-scan [DIR]  Generate hardware-configuration.nix in CWD or DIR

Notes:
  setup clones a fresh shallow inventory from bowenos-inventory-template.
  setup validates hostname characters, hostId format, and SSH key prefix.
  target in host local.nix must be one of: compute, computeplusstorage, storage, spine.
  mirror disk mode requires at least two distinct disks.
  install requires /mnt/persist (inventory is copied to /mnt/persist/etc/bowenos); run partition first.
  update may mount boot ESPs before rebuild.
USAGE
